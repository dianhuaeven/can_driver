# =============================================================================
# can_driver_node 硬件参数配置
# =============================================================================
# 本文件由 ROS 参数服务器加载（见 launch/can_driver.launch），
# 所有参数挂载在 /can_driver_node/ 命名空间下，
# 节点通过 pnh.getParam("joints", ...) 读取。
# =============================================================================

can_driver_node:

  # 控制循环频率（Hz）
  # CanDriverHW::read() → controller_manager::update() → CanDriverHW::write()
  # 每秒执行的次数。100 Hz = 10 ms 一个周期，适合大多数工业电机。
  # 若 CAN 总线负载过高可适当降低（如 50 Hz）。
  control_frequency: 100.0

  # --------------------------------------------------------------------------
  # joints：关节列表
  # --------------------------------------------------------------------------
  # 每个条目描述一个"逻辑关节"到"物理电机"的映射关系。
  # ros_control 通过 joint name 与 URDF、MoveIt moveit_config 三处��齐，
  # 因此 name 字段必须与 URDF 中的 <joint name="..."> 完全一致。
  # --------------------------------------------------------------------------
  joints:

    # --- 底盘差速驱动轮 ---
    # 由 diff_drive_controller/DiffDriveController 控制（见 ros_controllers.yaml）
    # 使用 MT 协议（迈信 EP 系列），CAN ID 范围 0x141~0x1FF

    - name: left_wheel          # 关节名，须与 URDF 一致
      motor_id: 0x141           # 电机 CAN Node ID（十六进制），MT 协议范围 0x01~0xFF
      protocol: MT              # 协议类型：MT = 迈信协议；PP = EyouCan(PP) 协议
      can_device: vcan0         # 虚拟 CAN 接口（测试用），实物联调时改回 can0
      control_mode: velocity    # 控制模式：velocity = 速度环；position = 位置环

    - name: right_wheel
      motor_id: 0x142
      protocol: MT
      can_device: vcan0
      control_mode: velocity

    # --- 机械臂关节（UR5 仿真测试用）---
    # 由 position_controllers/JointTrajectoryController 控制（见 ros_controllers.yaml）
    # 使用 PP 协议（EyouCan），CAN ID 范围 0x00~0xFF（即 motor_id 本身）
    # 注意：关节名必须与 UR5 URDF 完全一致，实物联调时改回实际关节名

    - name: shoulder_pan_joint  # UR5 第 1 轴（肩部旋转）
      motor_id: 0x06
      protocol: PP
      can_device: vcan1         # 虚拟 CAN 接口（测试用），实物联调时改回 can1
      control_mode: position

    - name: shoulder_lift_joint # UR5 第 2 轴（肩部抬升）
      motor_id: 0x05
      protocol: PP
      can_device: vcan1         # 虚拟 CAN 接口（测试用），实物联调时改回 can1
      control_mode: position

    - name: elbow_joint         # UR5 第 3 轴（肘部）
      motor_id: 0x13
      protocol: PP
      can_device: vcan1         # 虚拟 CAN 接口（测试用），实物联调时改回 can1
      control_mode: position

    - name: wrist_1_joint       # UR5 第 4 轴（腕部 1）
      motor_id: 0x14
      protocol: PP
      can_device: vcan1         # 虚拟 CAN 接口（测试用），实物联调时改回 can1
      control_mode: position

    - name: wrist_2_joint       # UR5 第 5 轴（腕部 2）
      motor_id: 0x15
      protocol: PP
      can_device: vcan1         # 虚拟 CAN 接口（测试用），实物联调时改回 can1
      control_mode: position

    - name: wrist_3_joint       # UR5 第 6 轴（腕部 3）
      motor_id: 0x16
      protocol: PP
      can_device: vcan1         # 虚拟 CAN 接口（测试用），实物联调时改回 can1
      control_mode: position

    # --------------------------------------------------------------------------
    # 可选字段（未填写时默认 1.0）：
    #   position_scale: 1.0   # 协议原始位置值 → rad 的换算系数（raw * scale = rad）
    #   velocity_scale: 1.0   # 协议原始速度值 → rad/s 的换算系数
    # 示例：若电机上报单位为 0.01°，换算到 rad：
    #   position_scale: 0.0001745329   # = 0.01 * π/180
    # --------------------------------------------------------------------------
